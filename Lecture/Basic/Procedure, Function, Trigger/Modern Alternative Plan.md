-----
### 데이터베이스 로직의 함정과 현대적 대안
-----
1. 왜 지금은 잘 사용하지 않는가?
   - 편리해 보이는 이 기능들이 실무에서 외면받는 이유는 크게 세 가지
   - 유지보수의 어려움  : 데이터베이스에 비즈니스 로직이 들어가기 시작하면, 전체 시스템의 로직이 애플리케이션 코드와 데이터베이스 양쪽에 흩어지게 됨
     + 혼란의 시작 : 비즈니스 규칙을 변경해야 할 때, 개발자는 혼란에 빠지게 됨
       * "이 로직, 자바 코드에 있나? 아니면 데이터베이스 프로시저에 있나?" 로직을 추적하고 이해하는 데 드는 시간이 두 배가 되고, 수정 포인트를 잘못 찾아 버그를 만들 확률도 높아짐
     + 버전 관리의 어려움 : 애플리케이션 코드는 Git과 같은 버전 관리 시스템을 통해 체계적으로 변경 이력을 관리하고, 협업하며, 테스트 하지만, 데이터베이스에 저장된 프로시저나 트리거는 이러한 현대적인 버전 관리 흐름에 통합하기가 훨씬 더 까다로우며, 코드 리뷰, 테스트, 배포 과정이 복잡해지고 관리 포인트가 늘어남

   - 성능 및 확장성 문제
     + 과거에는 애플리케이션 서버보다 데이터베이스 서버가 월등히 성능이 좋은 '가장 비싼 컴퓨터'였으며, 따라서 DB 서버에 일을 몰아주는 것이 합리적이었으나, 하지만 지금은 상황이 완전히 바뀌게 됨
     + 데이터베이스의 병목 현상 : 모든 비즈니스 로직(복잡한 계산, 조건문, 반복문 등)이 데이터베이스에 집중되면, DB 서버의 CPU는 데이터 입출력뿐만 아니라 애플리케이션 로직까지 처리하느라 과부하에 걸리게 됨
       * 데이터베이스는 시스템 전체의 성능을 좌우하는 핵심적인 지점이자 병목(bottleneck)이 되기 쉬움

     + 확장성의 차이 : 현대적인 웹 서비스는 수평적 확장(Horizontal Scaling)에 유리하도록 설계, 즉, 사용자가 몰리면 비교적 저렴한 애플리케이션 서버를 여러 대 증설하여 부하를 분산시킴
       * 하지만 데이터베이스 서버는 상대적으로 수평적으로 확장하기가 어렵고, 성능을 높이려면 보통 더 비싼 장비로 교체하는 수직적 확장(VerticalScaling)에 의존해야 하는데, 이는 비용이 기하급수적으로 비싸고 그마저도 한계가 명확 (샤딩 등의 기술을 사용하면 데이터베이스의 수평 확장이 가능하지만, 관리와 운영이 어려움)
       * 따라서 현대 아키텍처의 기본 원칙은, 값싸고 쉽게 확장할 수 있는 애플리케이션 서버가 비즈니스 로직 처리를 담당하 고, 비싸고 확장하기 어려운 데이터베이스는 데이터 저장 및 관리에만 집중하도록 역할을 명확히 분리하는 것

   - 특정 데이터베이스에 대한 종속성 (한 번 종속되면 빠져나올 수 없다)
      + 저장 프로시저, 함수, 트리거를 작성하는 데 사용되는 절차적 SQL 언어는 데이터베이스 제조사마다 다름
        * Oracle : PL/SQL
        * MS SQL Server : T-SQL
        * PostgreSQL : PL/pgSQL
        * MySQL : 자체적인 문법

      + 만약 Oracle의 PL/SQL로 수백 개의 복잡한 프로시저를 작성했는데, 몇 년 뒤 비용 문제로 MySQL이나 다른 오픈소스 데이터베이스로 이전하기로 결정했다면, 기존에 작성했던 모든 데이터베이스 로직을 새로운 데이터베이스의 문법에 맞춰 전부 새로 작성해야 함
      + 이것은 엄청난 시간과 비용을 유발하며, 사실상 데이터베이스 이전을 불가능하게 만드는 '기술적 부채'이자 '벤더 종속(Vendor Lock-in)'의 덫이 됨

2. 💡 현대의 대안 : 명확한 역할 분리
   - 현대적인 애플리케이션 개발의 대안은 명확한 역할 분리
   - 애플리케이션 계층 : 비즈니스 로직, 데이터 가공, 조건 처리, 절차 제어 등 모든 지능적인 처리를 담당하며, 데이터베이스와는 표준 SQL을 통해 소통
   - 데이터베이스 계층 : 오직 데이터의 저장, 조회, 무결성 보장(제약 조건), 트랜잭션 관리라는 데이터 본연의 역할에만 충실 (이러한 접근 방식은 시스템을 더 유연하고, 확장 가능하며, 유지보수하기 쉽게 만듬)

3. 최종 정리
   - 물론 저장 프로시저와 같은 기능이 완전히 쓸모없다는 뜻은 아님
   - 데이터 웨어하우징(DW) 환경에서 대용량 데이터를 배치 처리하거나, DBA가 특정 관리 작업을 자동화하는 등 여전히 유용하게 쓰이는 특정 영역이 존재
